# Single element analysis
The 1st example is a single element analysis. In this example, we use 2 different methods to analyze the mechanical response of a representative volume element (RVE). The microstructure is shown in the figure below.

```{figure} ../Figs/microstructure.png
---
height: 350px
name: micro
---
Microstructure used for single element analysis
```

where the yellow color is the fiber, the blue color represents matrix. The size of the microstructure is 50 voxels by 50 voxels.

In the analysis, the fiber is modeled using isotropic linear elasticity ($E_f = 500 MPa, \nu_f = 0.19$). Matrix is modeled using istropic elasto-plasticity ($E_m = 300 MPa$, $\nu_m = 0.3$). The yield curve for the matrix is defined as $\sigma_{y1} = 2MPa, \epsilon_{p1} = 0.0; \sigma_{y2} = 2.01 MPa, \epsilon_{p2} = 0.001$.


In the first method, we analyze the mechanical response of the microstructure under uniaxial loading using single scale analysis with SCA. The julia code is shown below

```none
function main()

#Mesh 
#Loading a mesh from saved mat file
mesh=Mesh_Mod.load_voxel_mesh()

#Define material properties
inclusion=MaterialProp.Inclusion(500,0.19)
matrix=MaterialProp.Matrix(100,0.3)
H = [0 2; 0.01 2.01]

#Offline analysis and clustering
SCA_offline.calcualte_offline(mesh, matrix,inclusion, 16, 2)

#Online analysis
stress, strain=SCA_online.calculate_online(mesh, matrix,inclusion,H,1,0.05,0.002)

#Post-processing: strain-stress plot
plot(strain, stress, xlabel="Strain", ylabel="Stress (MPa)", legend=false)
end

#main function
main()
```


In the second method, however, we use FE-SCA analysis, where an element with unit length is used in the finite element analysis. SCA is used as in the microscale analysis. The single element used in FE-SCA is shown in the figure below.


```{figure} ../Figs/Abaqus.png
---
height: 350px
name: micro
---
Microstructure used for single element analysis
```

The input file for the part scale Abaqus is shown as follows.


```none
*Heading
** Job name: single_axis1 Model name: single_axis1
** Generated by: Abaqus/CAE 2021
*Preprint, echo=NO, model=NO, history=NO, contact=NO
**
** PARTS
**
*Part, name=PART-1
*Node
      1,           0.,           0.,           0.
      2,  0.100000001,           0.,           0.
      3,  0.100000001,  0.100000001,           0.
      4,           0.,  0.100000001,           0.
      5,           0.,           0.,  0.100000001
      6,  0.100000001,           0.,  0.100000001
      7,  0.100000001,  0.100000001,  0.100000001
      8,           0.,  0.100000001,  0.100000001
*Element, type=C3D8R
1, 1, 2, 3, 4, 5, 6, 7, 8
*Elset, elset=ONE
 1,
*Orientation, name=Ori-1
          1.,           0.,           0.,           0.,           1.,           0.
3, 0.
** Section: Section-1-ONE
*Solid Section, elset=ONE, orientation=Ori-1, controls=EC-1, material=SCA1
,
*End Part
**  
**
** ASSEMBLY
**
*Assembly, name=Assembly
**  
*Instance, name=PART-1-1, part=PART-1
*End Instance
**  
*Nset, nset=GLOBAL, instance=PART-1-1, generate
 1,  8,  1
*Nset, nset=Set-2, instance=PART-1-1
 1,
*Nset, nset=Set-3, instance=PART-1-1
 4,
*Nset, nset=Set-4, instance=PART-1-1
 5, 8
*Nset, nset=Set-5, instance=PART-1-1
 5,
*Nset, nset=Set-6, instance=PART-1-1
 2, 3, 6, 7
*Nset, nset=Set-7, instance=PART-1-1
 2, 6
*Nset, nset=Set-8, instance=PART-1-1
 3,
*End Assembly
** 
** ELEMENT CONTROLS
** 
*Section Controls, name=EC-1, hourglass=ENHANCED
1., 1., 1.
** 
** MATERIALS
** 
** HOURGLASS STIFFNESS
**  6.7626E+00
** 
**  MATERIALS
** 
** 
** COMMENTS FROM *DEPVAR
** =====================
** 
**  Number of state variables 10*Np+5
*Material, name=SCA1
*Damping, alpha=0.1
*Density
 0.1,
*Depvar, delete=517
    700,
*User Material, constants=24
100.,    0.3,   500.,   500.,   500.,   0.19,   0.19,   0.19
   210.,   210.,   210.,   100.,    0.3,    0.7,     0.,     0.
     1.,     1.,     1.,    0.5,100000.,    50.,    50.,     5.
** ----------------------------------------------------------------
** 
** STEP: Step-1
** 
*Step, name=Step-1, nlgeom=NO
*Dynamic, Explicit
, 1.
*Bulk Viscosity
0.06, 1.2
** 
** BOUNDARY CONDITIONS
** 
** Name: BC-1 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-2, 1, 1
Set-2, 2, 2
Set-2, 3, 3
** Name: BC-2 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-3, 1, 1
Set-3, 3, 3
** Name: BC-3 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-4, 1, 1
** Name: BC-4 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-5, 2, 2
** Name: BC-5 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-6, 1, 1, 0.0015
** Name: BC-6 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-7, 2, 2
** Name: BC-7 Type: Velocity/Angular velocity
*Boundary, type=VELOCITY
Set-8, 3, 3
** 
** OUTPUT REQUESTS
** 
*Restart, write, number interval=1, time marks=NO
** 
** FIELD OUTPUT: F-Output-1
** 
*Output, field, number interval=100
*Element Output, directions=YES
E, S, SDV
** 
** FIELD OUTPUT: F-Output-2
** 
*Node Output
U, 
*Output, history, frequency=0
*End Step
```

The comparison of the single scale analysis and 2 scale FE-SCA analysis is compared in the following figure.

```{figure} ../Figs/uni_tension.png
---
height: 350px
name: micro
---
Microstructure used for single element analysis
```